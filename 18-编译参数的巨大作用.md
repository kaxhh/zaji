### 编译参数的巨大作用

作为一个嵌入式开发人员，熟练使用gcc等编译工具是必备的手段。但我之前从未想过编译参数的巨大作用，直到有一天。。。

同事想使用地址偏移的方式进行调用，而不是把被调用函数的地址放到寄存器里面去。这可怎么办呢？

通过查看编译参数，发现如果有**-mlongcall**参数，编译出来的.o文件，反汇编出来可以看到，bctrl，就是说把地址放到ctr寄存器中，然后跳转时在ctr寄存器中去找地址。这样的好处是不管地址在内存的哪个位置，都可以跳转过去执行。

但如果要地址偏移呢？

我们就可以取消掉**-mlongcall**参数，这样的话，跳转则用的是bl，而不会再去ctr寄存器中找地址，而是该地址本身就包含在了指令中！

但这样有一个坏处就是，本来指令只有32位，操作码占去8位，只有24位可用来保存地址，即只有24位(16MB)的寻址空间。

你看，只是一个编译参数的不同，相同的C文件编译出了不同的.s文件，以及生成不同的.o文件。

PS：

==以上讨论的体系结构是PPC==



​                                                                                                                                   *writed by luosy*