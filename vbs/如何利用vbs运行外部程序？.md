# 如何利用vbs运行外部程序？

VBScript只提供了一个编程的基本框架，用户可以使用vbs来定义变量、过程和函数，vbs也提供了一些内部函数和对象，但是vbs没有提供任何命令来访问Windows系统内部的部件，但是值得庆幸的是，vbs虽然不能完成这些任务，但是它提供了一条极为方便、功能也相当强的命令—createObject，这条命令可以访问Windows系统内安装的所有com对象，并且可以调用这些部件中存放的命令。

于是，问题解决了。比如，我手头上有1000个小文本，我首先对每一个文本的语法进行查错和修改，然后按照预先定义好的规则对这些文本进行排序，嘴和将这些文本合并成为一个文件。正常情况下，我们需要打开第一个小文本，然后把它复制到word中，然后利用里面的出错功能进行排错和修改，然后再导入到EXCEL中进行排序，将这个过程重复1000次，然后再将所有得到的文本复制到一个大文本中。实在是太枯燥、工作量太大了。

有了**Vbs**和**CreateObject**，问题得到解决，我只需要找到相应的模块，调用相应的功能就可以了，作为脚本，把一个枯燥的过程重复1000次，本就是它的拿手好戏。我在这里看到了Python的影子，Python就是vbs的全平台开源进化版吧！

ok，就让我们走入正题，从最简单的——只启动一个程序开始。

WSH也就是用来解析vbs的宿主，本身包含了几个常用对象。

1. Scripting.FileSystemObject      提供一整套文件系统操作函数
2. Scripting.Dictionary                  用来返回存放键值对的字典对象
3. Wscript.Shell                              提供一套读取系统信息的函数，如读写注册表、查找指定文件的路径、读取DOS环境变量，读取链接中的设置
4. Wscript.NetWork                      提供网络连接和远程打印机管理的函数。（**其中，所有Scripting对象都存放在SCRRUN.DLL文件中，所有的Wscript对象都存放在WSHOM.ocx文件中。**）

现在我们需要的是第三个对象，好了，让我们先连接一下对象看看，在记事本的编辑窗口中输入：

```vbscript
Set objShell = CreateObject(“Wscript.Shell”)
objShell.Run “notepad”
```

同样，保存执行。那么看到了一个什么样的结果呢？在桌面上又打开了一个记事本。

**说明之一：**

Set是vbs指令，凡事将一对象引用赋给变量，就需要使用set关键字。那什么是对象引用呢？凡是字符串、数值、布尔值之外的变量都是对象引用。Objshell是变量名，可以随意修改。

**说明之二：**

反是正确引用的对象，其本身内置有函数和变量，其引用方法为在变量后加“.”，后紧跟其实现功能的函数就可以了。

Objshell.run 的意思就是调用Wscript.shell中的运行外部程序的函数——run，notepad是记事本程序的文件名。当然你也可以改成“calc”，这是计算器的文件名，winword是word的文件名，等等吧，所有可执行文件的文件名都可以。但是需要注意的是，如果你要执行的可执行文件存放的地方不是程序安装的常用路径，一般情况下，需要提供合法的路径名，但是run在运行解析时，遇到空格会停止，解决的方法是使用双引号，例如：在我的机器上运行qq，代码为：

objshell.run """C:\Program Files\QQ2006\QQ.exe"""注：三个引号。

好， 我们再进一步，启动两个程序会如何呢？

输入如下代码：

```vbscript
Set objShell = CreateObject(“Wscript.Shell”)
objShell.Run “notepad”
objShell.Run “calc”
```

执行会如何呢？两个程序基本上同时启动了。如果我们需要先启动notepad再启动calc将如何呢？很简单在需要顺序执行的代码后加 , , True参数就可以了。

好了输入代码：

```vbscript
Set objShell = CreateObject(“Wscript.Shell”)
objShell.Run “notepad” ,,true
objShell.Run “calc”
```

看看执行的结果怎么样吧！

**总结：**

run函数有三个参数:

1. 第一个参数是你要执行的程序的路径;
2. 第二个程序是窗口的形式，0是在后台运行；1表示正常运行；2表示激活程序并且显示为最小化；3表示激活程序并且显示为最大化；一共有10个这样的参数我只列出了4个最常用的。
3. 第三个参数是表示这个脚本是等待还是继续执行，如果设为了true,脚本就会等待调用的程序退出后再向后执行。

其实，run作为函数，前面还有一个接受返回值的变量，一般来说如果返回为0，表示成功执行，如果不为0，则这个返回值就是错误代码，可以通过这个代码找出相应的错误。

~~好想说，VBScript的关键字和函数，真他妈丑！~~



